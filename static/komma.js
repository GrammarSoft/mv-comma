/* js-cookie v2.1.3 | MIT */
!function(f){var e=!1;if("function"==typeof define&&define.amd&&(define(f),e=!0),"object"==typeof exports&&(module.exports=f(),e=!0),!e){var h=window.Cookies,g=window.Cookies=f();g.noConflict=function(){return window.Cookies=h,g}}}(function(){function d(){for(var f=0,e={};f<arguments.length;f++){var h=arguments[f];for(var g in h){e[g]=h[g]}}return e}function c(b){function a(A,z,y){var x;if("undefined"!=typeof document){if(arguments.length>1){if(y=d({path:"/"},a.defaults,y),"number"==typeof y.expires){var w=new Date;w.setMilliseconds(w.getMilliseconds()+86400000*y.expires),y.expires=w}try{x=JSON.stringify(z),/^[\{\[]/.test(x)&&(z=x)}catch(v){}return z=b.write?b.write(z,A):encodeURIComponent(z+"").replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),A=encodeURIComponent(A+""),A=A.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),A=A.replace(/[\(\)]/g,escape),document.cookie=A+"="+z+(y.expires?"; expires="+y.expires.toUTCString():"")+(y.path?"; path="+y.path:"")+(y.domain?"; domain="+y.domain:"")+(y.secure?"; secure":"")}A||(x={});for(var u=document.cookie?document.cookie.split("; "):[],t=/(%[0-9A-Z]{2})+/g,s=0;s<u.length;s++){var r=u[s].split("="),q=r.slice(1).join("=");'"'===q.charAt(0)&&(q=q.slice(1,-1));try{var p=r[0].replace(t,decodeURIComponent);if(q=b.read?b.read(q,p):b(q,p)||q.replace(t,decodeURIComponent),this.json){try{q=JSON.parse(q)}catch(v){}}if(A===p){x=q;break}A||(x[p]=q)}catch(v){}}return x}}return a.set=a,a.get=function(e){return a.call(a,e)},a.getJSON=function(){return a.apply({json:!0},[].slice.call(arguments))},a.defaults={},a.remove=function(e,f){a(e,"",d(f,{expires:-1}))},a.withConverter=c,a}return c(function(){})});
/*
 * jQuery scrollintoview() plugin and :scrollable selector filter
 * https://github.com/litera/jquery-scrollintoview
 *
 * Version 1.8 (14 Jul 2011)
 * Requires jQuery 1.4 or newer
 *
 * Copyright (c) 2011 Robert Koritnik
 * Licensed under the terms of the MIT license
 * http://www.opensource.org/licenses/mit-license.php
 */
"use strict";(function(f){var c={vertical:{x:false,y:true},horizontal:{x:true,y:false},both:{x:true,y:true},x:{x:true,y:false},y:{x:false,y:true}};var b={duration:"fast",direction:"both"};var e=/^(?:html)$/i;var g=function(k,j){j=j||(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(k,null):k.currentStyle);var i=document.defaultView&&document.defaultView.getComputedStyle?true:false;var h={top:(parseFloat(i?j.borderTopWidth:f.css(k,"borderTopWidth"))||0),left:(parseFloat(i?j.borderLeftWidth:f.css(k,"borderLeftWidth"))||0),bottom:(parseFloat(i?j.borderBottomWidth:f.css(k,"borderBottomWidth"))||0),right:(parseFloat(i?j.borderRightWidth:f.css(k,"borderRightWidth"))||0)};return{top:h.top,left:h.left,bottom:h.bottom,right:h.right,vertical:h.top+h.bottom,horizontal:h.left+h.right}};var d=function(h){var j=h.closest("html");var i=e.test(h[0].nodeName);return{border:i?{top:0,left:0,bottom:0,right:0}:g(h[0]),scroll:{top:(i?j:h).scrollTop(),left:(i?j:h).scrollLeft()},scrollbar:{right:i?0:h.innerWidth()-h[0].clientWidth,bottom:i?0:h.innerHeight()-h[0].clientHeight},rect:(function(){var k=h[0].getBoundingClientRect();return{top:i?0:k.top,left:i?0:k.left,bottom:i?h[0].clientHeight:k.bottom,right:i?h[0].clientWidth:k.right}})()}};f.fn.extend({scrollintoview:function(j){j=f.extend({},b,j);j.direction=c[typeof(j.direction)==="string"&&j.direction.toLowerCase()]||c.both;var n="";if(j.direction.x===true){n="horizontal"}if(j.direction.y===true){n=n?"both":"vertical"}var l=this.eq(0);var i=l.closest(":scrollable("+n+")");if(i.length>0){i=i.eq(0);var m={e:d(l),s:d(i)};var h={top:m.e.rect.top-(m.s.rect.top+m.s.border.top),bottom:m.s.rect.bottom-m.s.border.bottom-m.s.scrollbar.bottom-m.e.rect.bottom,left:m.e.rect.left-(m.s.rect.left+m.s.border.left),right:m.s.rect.right-m.s.border.right-m.s.scrollbar.right-m.e.rect.right};var k={};if(j.direction.y===true){if(h.top<0){k.scrollTop=m.s.scroll.top+h.top-25}else{if(h.top>0&&h.bottom<0){k.scrollTop=m.s.scroll.top+Math.min(h.top,-h.bottom)+25}}}if(j.direction.x===true){if(h.left<0){k.scrollLeft=m.s.scroll.left+h.left-25}else{if(h.left>0&&h.right<0){k.scrollLeft=m.s.scroll.left+Math.min(h.left,-h.right)+25}}}if(!f.isEmptyObject(k)){if(e.test(i[0].nodeName)){i=l.closest("html");i.add("body",i)}i.animate(k,j.duration).eq(0).queue(function(o){f.isFunction(j.complete)&&j.complete.call(i[0]);o()})}else{f.isFunction(j.complete)&&j.complete.call(i[0])}}return this}});var a={auto:true,scroll:true,visible:false,hidden:false};f.extend(f.expr[":"],{scrollable:function(k,i,n,h){var m=c[typeof(n[3])==="string"&&n[3].toLowerCase()]||c.both;var l=(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(k,null):k.currentStyle);var o={x:a[l.overflowX.toLowerCase()]||false,y:a[l.overflowY.toLowerCase()]||false,isRoot:e.test(k.nodeName)};if(!o.x&&!o.y&&!o.isRoot){return false}var j={height:{scroll:k.scrollHeight,client:k.clientHeight},width:{scroll:k.scrollWidth,client:k.clientWidth},scrollableX:function(){return(o.x||o.isRoot)&&this.width.scroll>this.width.client},scrollableY:function(){return(o.y||o.isRoot)&&this.height.scroll>this.height.client}};return m.y&&j.scrollableY()||m.x&&j.scrollableX()}})})(jQuery);
/*
 * Copyright 2016-2018 GrammarSoft ApS <info@grammarsoft.com> at https://grammarsoft.com/
 * All Rights Reserved
 * Linguistic backend by Eckhard Bick <eckhard.bick@gmail.com>
 * Frontend by Tino Didriksen <mail@tinodidriksen.com>
 */
"use strict";var ctypes={"%k-list":["<h3>1.3 Komma ved opremsning af ord og sætninger.</h3>Komma erstatter <i>og</i>, hvis der er mere end to led efter hinanden.<br><br><i>Man kunne købe is, chokolade og varme pølser.<br><br>Fluerne summede, og fuglene sang, kvidrede og legede.</i>",1],"%k-list-ADJ":["<h3>1.3 Komma ved opremsning af adjektiver.</h3>Komma erstatter <i>og</i>, hvis der er mere end to adjektiver efter hinanden.<br><br><i>Man kunne købe friske, røde og lækre æbler.</i>",1],"%k-title":["<h3>Komma ved stillingsbetegnelser og titler</h3>Der sættes komma mellem stillingsbetegnelser, titler, akademiske grader og lignende der ikke er forbundet med <i>og</i>.<br><br><i>Direktør, cand.mag. Torben Taastrup</i>",3],"%k-address":["<h3>Komma ved adresser</h3>Der sættes normalt komma mellem de enkelte dele af adresser og lignende beskrivelser, når de skrives ud i ét:<br><br><i>Mette Hansen, Kastanjevej 6, 2920 Charlottenlund</i>",3],"%k-reference":['<h3>Komma ved referencer</h3>Der sættes komma mellem stillingsbetegnelser, titler, akademiske grader og lign. der ikke er forbundet med <i>og</i>.<br><br><i>"Oprør fra Midten", Gyldendal, 1977, side 54</i>',3],"%ko":["<h3>Komma mellem adresse og tid</h3>Det er valgfrit, om man vil sætte komma mellem adresser og datoer/tidspunkter.<br><br><i>Næstved(,) 21. september 2001<br>fredag den 21. september 2001(,) kl. 16.00</i>",3],"%k-appo":["<h3>3.2 Komma ved apposition</h3>Der sættes komma omkring en apposition (en forklarende tilføjelse).<br><br><i>Den største danske å, <u>Gudenåen</u>, løber gennem Silkeborg.<br><br>Hendes bror, <u>firmaets bedste sælger</u>, blev fyret i går.</i>",3],"%k-appo-end":["<h3>3.2 Komma ved apposition</h3>Der sættes komma omkring en apposition (en forklarende tilføjelse).<br><br><i>Den største danske å, <u>Gudenåen</u>, løber gennem Silkeborg.<br><br>Hendes bror, <u>firmaets bedste sælger</u>, blev fyret i går.</i>",3],"%k-extra":["<h3>3.3 Komma ved tiltaleord</h3>Der sættes komma foran tiltaleord.<br><br><i>Kom herhen, <u>Hans</u>!</i><h3>3.4 Komma ved udråb</h3>Der sættes komma efter udråbsord.<br><br><i>Halløj, kom lige her.<br>Øv, nu gik bilen i stå.</i><h3>3.5 Komma ved frie prædikativer</h3>Der sættes komma før slutstillede frie prædikativer. Prædikativer er beskrivende ord og led. Fx <i>stille og roligt</i>.<br><br><i>Han står og venter, <u>stille og alene</u>.<br><br>Endelig nåede vi hjem med hele flokken, <u>glade over at være sluppet for uheld undervejs</u>.</i><h3>3.6 Komma ved ekstraposition</h3>Der sættes komma omkring ekstraposition. Ekstraposition er et ekstra forklarende ord eller led.<br><br><i>Jens, <u>ham</u> kan vi stole på.<br><br>På fredag, <u>da</u> skal jeg til læge.</i><h3>Komma ved spørgende tilføjelser</h3>Der sættes komma ved spørgende tilføjelser.<br><br><i>Du kommer på lørdag, <u>ikke</u>?<br><br>Hun er nok kommet i godt selskab, <u>hvad</u>?</i>",3],"%k-explain":["<h3>3.7 Komma ved forklaringer og præciseringer</h3>Der sættes komma ved forklaringer og præciseringer.<br><br><i>Vi skal rejse søndag, <u>uanset vejr og vind</u>.<br><br>Han håndterede værktøjet fint, <u>også den tunge hammer</u>.</i>",3],"%k-explain-evt":["<h3>Muligt komma ved forklaringer og præciseringer</h3>Der kan sættes komma ved forklaringer og præciseringer.<br><br><i>Turen må aflyses, dels på grund af vejret, dels på grund af mangel på tid.</i>",3],"%k-explain-end":["<h3>3.7 Komma omkring forklaringer og præciseringer</h3>Der sættes komma omkring forklaringer og præciseringer.<br><br><i>Vi skal rejse søndag, <u>uanset vejr og vind</u>, hvis vi vinder konkurrencen.<br><br>Køb lidt snack, <u>fx popcorn</u>, hvis du alligevel skal i Brugsen.</i>",3],"%k-rel":["<h3>2.3 Komma før parentetiske relativsætninger</h3>Der sættes komma før parentetiske relativsætninger, hvor ledsætningen godt kan udelades, uden at sammenhængen bliver meningsløs.<br><br><i>De kom en time for sent, <u>hvilket ikke overraskede os</u>.</i>",2],"%k-rel-end":["<h3>2.3 Komma omkring parentetisk relativsætninger</h3>Der sættes komma omkring parentetiske relativsætninger, hvor ledsætningen godt kan udelades, uden at sammenhængen bliver meningsløs.<br><br><i>I en toværelses-lejlighed, <u>hvor der ikke er plads til mange gæster</u>, kan sovesofaer være en god løsning.</i>",2],"%k-paren":["<h3>2.3 Komma før ledsætning</h3>Der sættes komma før selvstændige ledsætninger.<br><br><i>Han er altædende, <u>hvorimod hun dyrker at være vegetar</u>.</i>",2],"%k-paren-end":["<h3>Komma efter ledsætning</h3>Der sættes komma efter selvstændige ledsætninger.<br><br><i>De levede, <u>skulle man tro</u>, et helt andet familieliv end vores.</i>",2],"%ko-men":["<h3>Valgfrit komma foran men, der ikke forbinder to sætninger</h3>Der kan valgfrit sættes komma foran et <i>men</i>, der ikke forbinder to sætninger:<br><br><i>Huset var billigt(,) men faldefærdigt.<br><br>De var meget trætte(,) men lykkelige for sejren.</i>",3],"%k-men":["<h3>Komma omkring men-udtryk</h3>Der sættes komma omkring <i>men</i>-udtryk med en særlig grad af selvstændighed eller fremhævelse.<br><br><i>En træt, <u>men lykkelig</u>, vinder.</i>",3],"%k-men-end":["<h3>Komma omkring men-udtryk</h3>Der sættes komma omkring <i>men</i>-udtryk med en særlig grad af selvstændighed eller fremhævelse.<br><br><i>En træt, <u>men lykkelig</u>, vinder.</i>",3],"%k-main":["<h3>1.1 Komma mellem helsætninger</h3>Der sættes komma mellem helsætninger, når to eller flere helsætninger sættes sammen med et bindeord som <i>og</i>, <i>eller</i>, <i>men</i>, <i>for</i>, <i>så</i>. Komma står foran bindeordet.<br><br><i>Fuglene fløjtede, og solen skinnede varmt.<br><br>Fuglene fløjtede, men solen skinnede varmt.<br><br>Fuglene fløjtede, for solen skinnede varmt.</i><br><br>Verber i bydeform fungerer som subjekt og verballed (udsagnsled og grundled). Derfor er der helsætningskomma mellem to bydeformer.<br><br><i><u>Skrid</u>, og <u>kom</u> aldrig igen.</i>",1],"%nok-main":["<h3>Ingen komma mellem prædikater</h3>Der sættes ikke komma, når der optræder et subjekt og to verber.<br><br><i>De låste huset og tog af sted.</i>",3],"%k-quote-end":['<h3>1.2 Komma ved direkte tale</h3>Der sættes komma før inkvit (anførende sætning).<br><br><i>"Kom straks tilbage", råbte han.</i>',1],"%k-quote-start":['<h3>1.2 Komma omkring direkte tale</h3>Der sættes komma før og efter inkvit (anførende sætning).<br><br><i>"Jeg er på arbejde," sagde han, "også når du kommer hjem."</i>',1],"%k-ellision":["<h3>1.4 Komma ved ufuldstændige helsætninger</h3>Der sættes komma mellem helsætninger – også når den sidste sætning er ufuldstændig, altså mangler verbal/udsagnsled.<br><br><i>Hun gik til højre, han til venstre.</i>",1],"%k-FSend":["<h3>2.1 Komma efter ledsætninger</h3>Der skal sættes komma efter en ledsætning.<br><br><i><u>At døren var låst</u>, så jeg for sent.<br><br><u>Fordi hegnet var itu</u>, løb køerne væk.<br><br><u>Hvordan jeg skulle gøre det</u>, havde ingen fortalt.<br><br><u>Mens toget kørte videre</u>, holdt alle bilerne stille.</i>",2],"%ko-FSstart":["<h3>2.1 Komma før ledsætninger</h3>Der sættes komma før en ledsætning. Denne type komma kaldes startkomma.<br>Komma sættes som regel før bindeordet.<br><br><i>Jeg så, <u>at døren var låst</u>.<br><br>Køerne løb væk, <u>fordi hegnet var itu</u>.<br><br>Ingen havde fortalt, <u>hvordan jeg skulle gøre det</u>.<br><br>Fortæl mig nu, <u>hvornår du kommer tilbage</u>.<br><br>Biosfæren er den del af Jorden, <u>hvor levende væsner kan leve</u>.<br><br>En horst er et højtliggende område, <u>som er presset op fra jorden</u>.</i><br><br>En ledsætning er led i en helsætning og kan ikke stå alene.<br>Den indledes ofte med et bindeord. Fx <i>at</i>, <i>der</i>, <i>som</i>, <i>hvad</i>, <i>hvornår</i>, <i>fordi</i>, <i>efter at</i>, <i>selv om</i>, <i>mens</i>.<br><br>Hvis ledsætningen indledes med et hv-ord, sættes komma foran dette.<br><br><i>Jeg ved, <u>hvilken</u> vej vi skal gå.<br><br>Ved du, <u>hvem</u> der kommer?</i><h3>2.1 Komma efter ledsætninger</h3><i><u>At døren var låst</u>, så jeg for sent.<br><br><u>Fordi hegnet var itu</u>, løb køerne væk.<br><br><u>Hvordan jeg skulle gøre det</u>, havde ingen fortalt.<br><br><u>Mens toget kørte videre</u>, holdt alle bilerne stille.</i><h3>2.3 Komma før og efter indskudte ledsætninger</h3>Der sættes komma omkring indskudte ledsætninger.<br><br><i>Jeg så, <u>at døren var låst</u>, og råbte efter hjælp.<br><br>Køerne løb væk, <u>fordi hegnet var itu</u>, og blev aldrig fundet igen.<br><br>Ingen havde fortalt, <u>hvordan jeg skulle gøre det</u>, så jeg måtte prøve mig frem.<br><br>Forleden dag, <u>da vi mødtes på perronen</u>, lånte jeg ham 20 kroner.</i>",2],"%k-FSco":["<h3>Komma mellem sideordnede ledsætninger</h3>Der sættes komma mellem sideordnede ledsætninger.<br><br><i>Jeg så, <u>at døren var låst</u>, og <u>at postkassen ikke var tømt</u>.</i>",2],"%ko-FSco":["<h3>Komma mellem sideordnede ledsætninger</h3>Der sættes komma mellem sideordnede ledsætninger, der deler bindeord/konjunktion.<br><br><i>Hvis han igen er syg, og hun ikke vil rejse alene, må vi flytte ferien.</i>",2],"%nok-FSstart":["<h3>Forkert ledsætnings-startkomma</h3>Du har sat et ledsætnings-startkomma det forkerte sted.<br>Sandsynligvis skal kommaet flyttes til venstre, og programmet har forhåbentlig allerede markeret det korrekte sted. Reglerne er følgende:<br><br>1. Et komma må ikke adskille en sideordnende konjunktion fra den ledsætning, den sideordner.<br><i>Han var sulten, og [,] fordi køleskabet var tomt, købte han ind.</i><br><br>2. Et komma må ikke adskille indlederordet fra den ledsætning, det indleder. Dette gælder underordnende konjunktioner, spørgepronominer og relative pronominer, samt forklaringspartikler som <i>dvs</i>.<br><i>Du kan få rabat, mod [,] at du selv afhenter varen. Hun er ked af det, fordi [,] hendes kat har ædt hamsteren.</i><br><br>3. Et komma må kun adskille en præposition fra sin ledsætnings-styrelse, hvis præpositionen er tæt knyttet (valensbundet) til et element i hovedsætningen - altså ikke, hvis præpositionen udgør en løs tilføjelse.<br><i>Jeg tror [,] på, at vi vinder i aften.</i><br>Men: <i>Han inviterede hele landsbyen, i anledning af [,] at han blev 50.</i><br><br>4. Et komma må ikke adskille et adverbial fra den sætning, den betydningsmæssigt tilhører. Det skal altså stå før - og ikke efter - adverbier som <i>især</i> og <i>netop</i>, når de står i starten af en ledsætning.<br><i>Jeg hader regn, især [,] når det er koldt.</i>",2],"%ko-ellision-end":["<h3>Valgfrit komma efter ufuldstændige ledsætninger</h3>Valgfrit komma efter ufuldstændige ledsætninger, der mangler subjekt og verballed.<br><br><i>Hvis ikke (,) finder vi en anden løsning.<br>Skønt gammeldags (,) er det en fin film.</i>",2],"%nok-ellision":["<h3>Ikke komma foran ufuldstændige ledsætninger</h3><i>Skabet samles [,] som vist.</i>",2],"%k":["<h3>Ukendt komma</h3>Kommatypen er ukendt, men vi anbefaler dig at tjekke, om den sætning, hvor kommaet står, er korrekt.",1],"%k-stop":["<h3>Manglende sætningsbrud</h3>Der indsættes punktum, komma, kolon, semikolon eller linjeskift mellem to selvstændige sætninger, eller mellem en overskrift og første sætning.",1],"%nok-soft":["<h3>Overflødigt komma</h3>Dette komma er overflødigt, så du bør se på, om det skal være der. Du har måske sat det for at fremhæve noget i din tekst.",1],};
/*
 * Copyright 2016-2017 GrammarSoft ApS <info@grammarsoft.com> at https://grammarsoft.com/
 * All Rights Reserved
 * Linguistic backend by Eckhard Bick <eckhard.bick@gmail.com>
 * Frontend by Tino Didriksen <mail@tinodidriksen.com>
 */
"use strict";if(tinymce){tinymce.PluginManager.add("placeholder",function(a){a.on("init",function(){var c=new b;e();tinymce.DOM.bind(c.el,"click",d);a.on("focus",d);a.on("blur",e);a.on("change",e);function d(){c.hide();tinyMCE.execCommand("mceFocus",false,a)}function e(){if(a.getContent()==""){c.show()}else{c.hide()}}});var b=function(){this.text=a.getElement().getAttribute("placeholder");this.contentAreaContainer=a.getContentAreaContainer();tinymce.DOM.setStyle(this.contentAreaContainer,"position","relative");var c={id:"placeholder",style:{position:"absolute",top:"10px",left:"10px",color:"#777",padding:"1%",width:"98%",overflow:"hidden","text-align":"center","font-size":"200%"}};this.el=tinymce.DOM.add(this.contentAreaContainer,"label",c,this.text)};b.prototype.hide=function(){tinymce.DOM.setStyle(this.el,"display","none")};b.prototype.show=function(){tinymce.DOM.setStyle(this.el,"display","")}})}function select_text(c){c.focus();if(document.body.createTextRange){var a=c.offsetParent;while(a.offsetParent){a=a.offsetParent}var b=a.createTextRange();b.moveToElementText(c);b.select()}else{if(window.getSelection){var f=c.ownerDocument;var e=f.defaultView;var d=e.getSelection();var b=f.createRange();b.selectNodeContents(c);d.removeAllRanges();d.addRange(b)}}}jQuery.fn.selectText=function(){select_text(this[0]);return this};Array.prototype.unique=function(){var b=[];for(var a=0;a<this.length;++a){if(b.indexOf(this[a])==-1){b.push(this[a])}}return b};var Defs={CAP_ADMIN:(1<<0),CAP_COMMA:(1<<1),CAP_DANPROOF:(1<<2),CAP_AKUTUTOR:(1<<3),CAP_COMMA_TRIAL:(1<<4),CAP_DANPROOF_TRIAL:(1<<5),CAP_AKUTUTOR_TRIAL:(1<<6),OPT_COMMA_LEVEL_1:(1<<0),OPT_COMMA_LEVEL_2:(1<<1),OPT_COMMA_LEVEL_3:(1<<2),OPT_COMMA_GREEN:(1<<3),OPT_COMMA_MAYBE:(1<<4),OPT_COMMA_COLOR:(1<<5),OPT_DP_ONLY_CONFIDENT:(1<<0),OPT_DP_IGNORE_NAMES:(1<<1),OPT_DP_IGNORE_COMP:(1<<2),OPT_DP_IGNORE_ABBR:(1<<3),OPT_DP_IGNORE_OTHER:(1<<4),OPT_DP_IGNORE_MAJ:(1<<5),OPT_DP_COLOR:(1<<6),OPT_DP_USE_DICT:(1<<7),MAX_SESSIONS:5,MAX_RQ_SIZE:4096,"comma-commercial":"Kommaforslag Erhverv","comma-private":"Kommaforslag Privat","comma-student":"Kommaforslag Studerende","danproof-commercial":"Ret Mig Erhverv","danproof-private":"Ret Mig Privat","danproof-student":"Ret Mig Studerende","akututor-clinic":"Akututor Klinik","akututor-student":"Akututor Studerende",};Defs.OPT_DP_IGNORE_UNKNOWN=Defs.OPT_DP_IGNORE_NAMES|Defs.OPT_DP_IGNORE_COMP|Defs.OPT_DP_IGNORE_ABBR|Defs.OPT_DP_IGNORE_OTHER;var last_result="";var to_send=[];var to_send_i=0;var ts_xhr=null;var ts_slow=null;var ts_fail=0;var eht_timer=null;var eht_prevent=false;var cookie_hmac=null;var text_nodes=["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","CANVAS","DD","DIV","DL","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","LI","MAIN","NAV","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TD","TH","UL","VIDEO"];var tnjq=null;var itjq="B,BIG,I,SMALL,TT,ABBR,ACRONYM,CITE,CODE,DFN,EM,KBD,STRONG,SAMP,TIME,VAR,A,BDO,Q,SPAN,SUB,SUP,LABEL";var ccomma=null;var android=false;var iOS=false;function ga_log(a,b,c){if(!ga||typeof ga==="undefined"){return}ga("send","event",a,b,c)}function send_post(a,b){if(typeof b==="undefined"||!b){b={}}return $.ajax({url:a,type:"POST",dataType:"json",headers:{HMAC:cookie_hmac.sess_id},data:b,})}function log_click(a){$.post("./callback.php?a=click",{data:JSON.stringify(a)})}function log_error(a){$.post("./callback.php?a=error",{data:JSON.stringify(a)})}function log_warning(a){$.post("./callback.php?a=warning",{data:JSON.stringify(a)})}function is_upper(a){return(a===a.toUpperCase()&&a!==a.toLowerCase())}function uc_first(a){return a.substr(0,1).toUpperCase()+a.substr(1)}function escHTML(b){var a=b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;");return a}function decHTML(b){var a=b.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&amp;/g,"&");return a}function sortByLocale(d,c){return d.toUpperCase().localeCompare(c.toUpperCase())}function haveLocalStorage(){try{var c=window.localStorage;var a="LocalStorageTest";c.setItem(a,a);c.removeItem(a)}catch(b){return false}return true}function skipNonText(c,a){var b=true;while(b){b=false;while(/^\s$/.test(c.charAt(a))){++a}while(a<c.length&&c.charAt(a)==="<"){while(a<c.length&&c.charAt(a)!==">"){while(a<c.length&&c.charAt(a)==='"'){++a;while(a<c.length&&c.charAt(a)!=='"'){++a}++a}while(a<c.length&&c.charAt(a)==="'"){++a;while(a<c.length&&c.charAt(a)!=="'"){++a}++a}if(a<c.length&&c.charAt(a)!==">"){++a}}b=true;++a}while(a<c.length&&c.charAt(a)==="&"){while(a<c.length&&c.charAt(a)!==";"){++a}b=true;++a}while(/^\s$/.test(c.charAt(a))){++a}}return a}function check_slow(){$("#working").find("span").text("arbejder stadig, vent lidt");ts_slow=setTimeout(check_slow_2,5000)}function check_slow_2(){$("#working").find("span").text("er du sikker på at du har forbindelse?");ts_slow=setTimeout(check_slow_3,5000)}function check_slow_3(){$("#working").find("span").text("opgiver om 5 sekunder");ts_slow=setTimeout(check_slow_4,5000)}function check_slow_4(){last_result="";to_send=[];to_send_i=0;ccomma=null;ts_slow=null;checkDone();if(ts_xhr){ts_xhr.abort()}ts_xhr=null}function cleanEditorContent(){var a={A:/^(href)$/i,IMG:/^(src|width|height|hspace|vspace)$/i};$(tinyMCE.activeEditor.getBody()).find("*").removeClass().each(function(){var b=this.attributes;var c=b.length;while(c--){if(a.hasOwnProperty(this.nodeName)&&a[this.nodeName].test(b[c].name)){continue}this.removeAttributeNode(b[c])}})}function prepEditorContent(b){b.find('[class*="mce-"]').each(function(){if($.trim($(this).text()).length===0){$(this).remove()}});b.find("br").each(function(){if(this.parentNode&&this.parentNode.lastChild==this){this.parentNode.removeChild(this)}});var a=b.html();if(a.indexOf("&nbsp;")!=-1||a.indexOf("  ")!=-1){b.html(a.replace(/&nbsp;/g," ").replace(/ +/g," "))}b.removeAttr("contenteditable");b.css("overflow-y","scroll");b.find("div.unwrap").each(function(){$(this).children().unwrap()})}function findTextNodes(a){var b=[],d=/\S/;if(!$.isArray(a)){a=[a]}function e(g){if(g.nodeType==3){if(d.test(g.nodeValue)){b.push(g)}}else{for(var f=0;f<g.childNodes.length;++f){e(g.childNodes[f])}}}for(var c=0;c<a.length;++c){e(a[c])}return b}function checkAll(){check(this)}function danproof_login(a){$.post("./callback.php?a=login",{u:a}).success(function(){window.location="./"}).fail(function(){alert("Kunne ikke logge ind - er du sikker på at du har adgang til dette værktøj?")})}function danproof_logout(){send_post("./callback.php?a=logout").success(function(){window.location="./";window.location.reload(true)}).fail(function(){alert("Kunne ikke logge ud - er du sikker på at du har adgang til dette værktøj?")})}function logout_other(b){var a=$(b).closest("tr");send_post("./callback.php?a=logout-other",{s:a.attr("data-id")}).success(function(d){a.fadeOut();var c=cookie_hmac.sess_caps;cookie_hmac=Cookies.getJSON("comma-hmac");if(c!=cookie_hmac.sess_caps){$("#profile").on("hide.bs.modal",function(){window.location="./";window.location.reload(true)})}}).fail(function(){alert("Kunne ikke logge ud - er du sikker på at du har adgang til dette værktøj?")})}function profile_open(){send_post("./callback.php?a=get-profile").success(function(f){if(!f.hasOwnProperty("a")||f.a!=="get-profile"){return}if(!f.hasOwnProperty("profile")){alert("Kunne ikke åbne din profil - er du sikker på at du har adgang til dette værktøj?");return}var g=$("#profile");var d="";d+="<h3>Konto</h3>";d+="<b>Brugernavn</b>: "+escHTML(f.profile.u)+"<br>";d+='<b>Password</b>: <a href="https://gramtrans.com/wp-admin/profile.php" target="_blank">Skift password</a>';if(f.profile.a.length){d+="<h3>PayPal Abonnementer</h3>";d+='<div class="table-responsive"><table class="table table-striped">';for(var c=0;c<f.profile.a.length;++c){var b=f.profile.a[c];d+='<tr><td class="small">';d+="<b>Type</b>: "+escHTML(Defs[b.acl_which])+"<br>";d+="<b>ID</b>: "+escHTML(b.subscr_id)+"<br>";d+="<b>Løbetid</b>: "+(new Date(b.acl_start*1000).toLocaleDateString("da-DK"))+" → "+(new Date(b.acl_stop*1000).toLocaleDateString("da-DK"))+"<br>";d+='<b>Faktura</b>: <a href="./receipt?id='+escHTML(b.txn_id)+'">HTML</a>, <a href="./receipt?id='+escHTML(b.txn_id)+'&amp;fmt=pdf">PDF</a>';d+="</td><td>";d+='<a class="btn btn-warning" href="https://www.paypal.com/cgi-bin/webscr?cmd=_subscr-find&alias='+escHTML(b.receiver_id)+'" target="_blank">Administrer</a>';d+="</td></tr>"}d+="</table></div>"}if(f.profile.s.length){d+="<h3>Forbundne Enheder</h3>";d+='<div class="table-responsive"><table class="table table-striped">';for(var c=0;c<f.profile.s.length;++c){var e=f.profile.s[c];d+='<tr data-id="'+escHTML(e.sess_id)+'"><td class="small">';d+="<b>Enhed</b>: "+escHTML(e.sess_ua)+"<br>";d+="<b>IP</b>: "+e.sess_ip+"<br>";d+="<b>Sidst aktiv</b>: "+(new Date(e.sess_seen*1000).toLocaleString("da-DK"));d+="</td><td>";if(e.sess_id!==cookie_hmac.sess_id){d+='<button class="btn btn-warning" onclick="logout_other(this);">Fjern enhed</button>'}d+="</td></tr>"}d+="</table></div>"}g.find("h4.modal-title").text("Profil for "+f.profile.u);g.find("div.modal-body").html(d);g.modal("show")}).fail(function(){alert("Kunne ikke åbne din profil - er du sikker på at du har adgang til dette værktøj?")})}function profile_close(){$("#profile").modal("hide")}function redeem_handler(a){if(!a.hasOwnProperty("g")&&!a.hasOwnProperty("r")){alert("Svaret fra serveren var tomt");return}if(a.hasOwnProperty("r")){alert(a.r);return}if(a.hasOwnProperty("g")){redeem_close();alert(a.g);return}}function redeem_do(){var a=$.trim($("#redeem_email").val());var c=$.trim($("#redeem_email2").val());var b=$.trim($("#redeem_code").val().replace(/[^a-zA-Z0-9]+/g,""));if(a.length==0){alert("Mangler en gyldig email-addresse!");return}if(!/^.+@.+?\..+$/.test(a)){alert(a+" er ikke en gyldig email-addresse!");return}if(a!==c){alert("Email-addresserne skal være ens!");return}if(b.length==0){alert("Mangler en gyldig kode!");return}if(b.length!=15){alert(b+" er ikke en gyldig kode!");return}$.post("./callback.php?a=redeem",{email:a,code:b}).success(redeem_handler).fail(function(){alert("Kunne ikke indløse værdikoden. Er du sikker på den er gyldig?")})}function redeem_open(){if(window.location.hash&&/redeem=[-A-Za-z0-9]+/.test(window.location.hash)){var a=window.location.hash.replace(/^.*redeem=([-A-Za-z0-9]+).*$/g,"$1");$("#redeem_code").val(a)}$("#redeem").modal("show")}function redeem_close(){$("#redeem").modal("hide")}function paypal_close(a){$(a).closest("form").find(".popover").remove()}function paypal_submit(a){var b=$.trim($(a).closest("form").find("#school").val());if(b.length>=2){return true}alert("Feltet skal udfyldes med en navnet på en eksisterende institution.");return false}function shared_init(){cookie_hmac=Cookies.getJSON("comma-hmac");if(typeof cookie_hmac==="undefined"){cookie_hmac={sess_id:"",sess_caps:0,cnt:0}}$('input[name="item_number"]').each(function(){if($(this).val().indexOf("-student-")==-1){return}$(this).closest("form").find("button").off().click(function(){$(this).popover({html:true,content:'<div class="form-group"><label class="control-label" for="school">Hvilken uddannelsesinstitution / skole går du på?</label><input name="on0" type="hidden" value="Institution"><input name="os0" id="school" class="form-control"></div><div class="form-group"><button class="btn btn-default" onclick="paypal_close(this); return false;">Luk</button> <button type="submit" class="btn btn-primary" onclick="return paypal_submit(this);">Videre</button></div>',placement:"top",});$(this).popover("show");return false})})}function shared_hook(){if(window.location.hash){if(window.location.hash.indexOf("redeem")!=-1){setTimeout(redeem_open,500)}}}function sanitize_result(a){for(var d=0;d<Defs.MAX_RQ_SIZE;++d){var f="</s"+d+">";var e="<s"+(d+1)+">";var c=a.indexOf(f);var b=a.indexOf(e);if(c!==-1&&b!==-1&&b<c){a=a.replace(new RegExp("("+e+")((.|\\s)*?"+f+")","g"),"$2\n\n$1\n")}}a=a.replace(/<s\d+>[\s\n]*<\/s\d+>/g,"");a=a.replace(/^[^]*?(<s\d+>)/,"$1");a=a.replace(/(\n<\/s\d+>)[^]*?(<s\d+>\n)/g,"$1\n\n$2");return a}function renumerate_editor(){var c=$(tinyMCE.activeEditor.getBody());var e=$(findTextNodes(c.get(0))).closest(tnjq).get();for(var a=0;a<e.length;++a){var d=$(e[a]);var b=$.trim(d.html().replace(/<br\/?\s*>/g,"\n").replace(/<[^>]+>/g,""));if(!b){continue}var f=a+1;d.attr("id","s"+f)}}function transfer_document(){commaIgnoreAll();$(tinyMCE.activeEditor.getBody()).focus();tinyMCE.activeEditor.execCommand("selectAll");if(!iOS){tinyMCE.activeEditor.execCommand("copy")}ga_log("ui","transfer");var a=$("#transfer");a.find("input").val($(tinyMCE.activeEditor.getBody()).html());a.get(0).submit()}
/*
 * Copyright 2016-2018 GrammarSoft ApS <info@grammarsoft.com> at https://grammarsoft.com/
 * All Rights Reserved
 * Linguistic backend by Eckhard Bick <eckhard.bick@gmail.com>
 * Frontend by Tino Didriksen <mail@tinodidriksen.com>
 */
"use strict";tinymce.PluginManager.add("placeholder",function(a){a.on("init",function(){var c=new b;e();tinymce.DOM.bind(c.el,"click",d);a.on("focus",d);a.on("blur",e);a.on("change",e);function d(){c.hide();tinyMCE.execCommand("mceFocus",false,a)}function e(){if(a.getContent()==""){c.show()}else{c.hide()}}});var b=function(){this.text=a.getElement().getAttribute("placeholder");this.contentAreaContainer=a.getContentAreaContainer();tinymce.DOM.setStyle(this.contentAreaContainer,"position","relative");var c={id:"placeholder",style:{position:"absolute",top:"10px",left:"10px",color:"#444",padding:"1%",width:"98%",overflow:"hidden","text-align":"center","font-size":"200%"}};this.el=tinymce.DOM.add(this.contentAreaContainer,"label",c,this.text)};b.prototype.hide=function(){tinymce.DOM.setStyle(this.el,"display","none")};b.prototype.show=function(){tinymce.DOM.setStyle(this.el,"display","")}});var opt_seen=false;var opt_level=2;var opt_maybe=false;var opt_color=false;var opt_green=false;var opt_storage=false;var last_result=null;var to_send=[];var to_send_i=0;var ts_xhr=null;var ts_slow=null;var eht_timer=null;var text_nodes=["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","CANVAS","DD","DIV","DL","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","LI","MAIN","NAV","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TD","TH","UL","VIDEO"];var tnjq=null;var ccomma=null;var android=false;var iOS=false;function onResizeHandler(){var b=$(".mce-edit-area").find("iframe").first();$(".mce-tinymce").css("border","0");$(".mce-edit-area").height(100);b.height(100);var a=$("#container").innerHeight();a-=$("#headbar").outerHeight();a-=$("#footbar").outerHeight();a-=$("#ed-head").outerHeight();a-=$("#ed-foot").outerHeight();a-=40;a-=$(".mce-menubar.mce-toolbar").outerHeight();if($(".mce-toolbar-grp:visible").length){a-=$(".mce-toolbar-grp").outerHeight()}a-=$(".mce-statusbar").outerHeight();a-=1;$(".mce-edit-area").height(a);b.height(a);if(b.height()!=a){var a=b.height();$(".mce-edit-area").height(a);b.parent().height(a)}if(tinyMCE&&tinyMCE.activeEditor){$(tinyMCE.activeEditor.getBody()).css("min-height",a-20)}editorHasText()}function onResize(){setTimeout(onResizeHandler,500);setTimeout(onResizeHandler,1000)}$(function(){opt_storage=haveLocalStorage();if(opt_storage&&localStorage.getItem("opt_seen")){opt_seen=parseInt(localStorage.getItem("opt_seen"))==1;opt_level=parseInt(localStorage.getItem("opt_level"));opt_green=parseInt(localStorage.getItem("opt_green"))==1;opt_maybe=parseInt(localStorage.getItem("opt_maybe"))==1;opt_color=parseInt(localStorage.getItem("opt_color"))==1}tnjq=text_nodes.join(",");tinymce.init({selector:"textarea",menubar:false,statusbar:false,plugins:["searchreplace","paste","placeholder"],browser_spellcheck:true,language:"da",entity_encoding:"raw",language_url:"./static/da.js",content_css:"./static/inline.css?v=8351d335",setup:function(c){c.on("keyup paste change",function(){if(eht_timer){clearTimeout(eht_timer)}eht_timer=setTimeout(editorHasText,250)});c.on("copy",function(){commaIgnoreAll();ga_log("ui","copy")});c.on("paste",function(){commaIgnoreAll();setTimeout(cleanEditorContent,500);ga_log("ui","paste")});c.on("undo",function(){commaIgnoreAll();setTimeout(cleanEditorContent,500)});c.on("postRender",function(){var d=$("iframe");$("#working").show().offset(d.offset()).width(d.width()).height(d.height()).hide();$(".mce-toolbar-grp").hide();onResize();if(tinymce&&tinymce.i18n&&tinymce.i18n.data&&tinymce.i18n.data.da){tinymce.i18n.data.da.Blocks="Afsnit";tinymce.i18n.data.da.Inline="Skrifttype"}})}});checkDone();$("#btn-check,#btn-correct-all,#btn-wrong-all,#btn-copy,#btn-erase,#btn-close").addClass("disabled");$("#btn-check").click(function(){checkAll();ga_log("ui","check")});$("#btn-correct-all").click(function(){if($(this).hasClass("disabled")){return}$(tinyMCE.activeEditor.getBody()).find("span.comma-yes,span.comma-maybe").each(function(){ccomma=$(this);commaAccept()});ga_log("ui","correct-all")});$("#btn-wrong-all").click(function(){if($(this).hasClass("disabled")){return}$(tinyMCE.activeEditor.getBody()).find("span.comma-no").each(function(){ccomma=$(this);commaDiscard()});ga_log("ui","wrong-all")});$("#btn-erase").click(function(){$(tinyMCE.activeEditor.getBody()).text("");editorHasText();ga_log("ui","erase")});$("#btn-close").click(function(){commaIgnoreAll();ga_log("ui","close")});$("#btn-copy").click(function(){commaIgnoreAll();$(tinyMCE.activeEditor.getBody()).focus();tinyMCE.activeEditor.execCommand("selectAll");if(!iOS){tinyMCE.activeEditor.execCommand("copy")}ga_log("ui","copy")});$('[data-toggle="popover"]').popover();$("#btn-options").on("shown.bs.popover",optionsOpen).on("hide.bs.popover",optionsClose).click(function(){$(this).popover("toggle")});if(!opt_seen){$("#btn-options").popover("show")}$(window).on("resize",onResize);$(window).on("beforeunload",function(c){if(tinyMCE&&tinyMCE.activeEditor&&$(tinyMCE.activeEditor.getBody()).find("span.comma").length){var d="Er du sikker på at du vil lukke siden?";c.returnValue=d;return d}});$("#warning").hide();iOS=window.navigator.userAgent.indexOf("Apple")!==-1&&(window.navigator.userAgent.indexOf("iPad")!==-1||window.navigator.userAgent.indexOf("iPhone")!==-1||window.navigator.userAgent.indexOf("iPod")!==-1);android=(window.navigator.userAgent.indexOf("Android")!==-1);var a=window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);if(a&&parseInt(a[1])<537){var b='Din browser er for gammel. Du bør opgraderer til en nyere <a href="https://play.google.com/store/apps/details?id=com.android.chrome">Chrome</a> eller <a href="https://play.google.com/store/apps/details?id=org.mozilla.firefox">Firefox</a>.';$("#warning").html(b).show();alert(b.replace(/<[^>]+>/g,""))}if(iOS){$("#btn-copy").find(".text").text("Vælg alt tekst i dokumentet")}});function editorHasText(){eht_timer=null;if(!tinyMCE||!tinyMCE.activeEditor){return}var a=tinyMCE.activeEditor.getBody();var b=$(a);if(b.find("span.comma-yes,span.comma-maybe").length){$("#btn-correct-all").removeClass("disabled")}else{$("#btn-correct-all").addClass("disabled")}if(b.find("span.comma-no").length){$("#btn-wrong-all").removeClass("disabled")}else{$("#btn-wrong-all").addClass("disabled")}if(b.find("span.comma").length){b.removeAttr("contenteditable")}else{b.attr("contenteditable",true);b.css("overflow-y","");last_result=null}if(a.childNodes.length&&a.textContent.length){$("#btn-check,#btn-copy,#btn-erase").removeClass("disabled");$("#placeholder").hide()}else{$("#btn-check,#btn-copy,#btn-erase").addClass("disabled");$("#placeholder").show()}$(a).find("span.comma").popover("destroy");ccomma=null}function doneOpen(a){$(a).popover("show");setTimeout(function(){$(a).popover("hide")},4000)}function optionsOpen(){$('input[name="opt_level"]').prop("checked",false);$('input[name="opt_level"][value="'+opt_level+'"]').prop("checked",true);$("#opt_green").prop("checked",opt_green);$("#opt_maybe").prop("checked",opt_maybe);$("#opt_color").prop("checked",opt_color);$("#btn-options-close").off().click(function(){$("#btn-options").popover("hide")})}function optionsClose(){if($("#btn-options").hasClass("disabled")){return}opt_level=$('input[name="opt_level"]:checked').val();opt_green=$("#opt_green").prop("checked");opt_maybe=$("#opt_maybe").prop("checked");opt_color=$("#opt_color").prop("checked");if(opt_storage){localStorage.setItem("opt_seen",1);localStorage.setItem("opt_level",opt_level);localStorage.setItem("opt_green",opt_green?1:0);localStorage.setItem("opt_maybe",opt_maybe?1:0);localStorage.setItem("opt_color",opt_color?1:0)}if(last_result){$("#btn-options").addClass("disabled");commaIgnoreAll();var a=last_result;parseCommas(last_result);last_result=a}editorHasText();ga_log("options","close","["+opt_level+","+opt_green+","+opt_maybe+","+opt_color+"]")}function commaPopup(l,g){var m=tinyMCE.activeEditor.getBody();var e=$(m);e.find(".popover").remove();e.find("span.comma").popover("destroy");if(!g&&ccomma&&ccomma.get(0)===l){ccomma=null;return}ccomma=$(l);ccomma.focus();var n="Indsæt komma";var a="Fjern komma";if(ccomma.hasClass("comma-no")){n="Behold komma"}if(ccomma.attr("data-types").indexOf("%k-stop")!=-1){n=n.replace(" komma"," punktum");a=a.replace(" komma"," punktum")}var j='<div id="popup">';j+='<a onclick="window.parent.commaAccept();"><span class="icon icon-accept"></span><span>'+n+"</span></a>";j+='<a onclick="window.parent.commaDiscard();"><span class="icon icon-discard"></span><span>'+a+"</span></a>";if(android){j+='<a onclick="window.parent.commaIgnoreAll();"><span class="icon icon-edit"></span><span>Rediger tekst</span></a>'}if(!g){j+='<a onclick="window.parent.commaExplain();"><span class="icon icon-explain"></span><span>Se forklaring</span></a>'}j+="</div>";if(g){j+='<div id="explanation">';var k=ccomma.attr("data-types").split(/ /g);for(var h=0;h<k.length;++h){j+=ctypes[k[h]][0]}j+="</div>"}var d=null;if(ccomma.offset().left+ccomma.width()<e.width()-100){d=m}var f="auto bottom";if(ccomma.offset().top<300){f="bottom"}ccomma.popover({animation:false,content:j,html:true,placement:f,trigger:"manual",viewport:d,}).on("shown.bs.popover",function(){e.find("div.popover").scrollintoview()});ccomma.popover("show");e.find(".popover")}function commaInlineClick(){commaPopup(this,false);ga_log("comma","click")}function commaExplain(){commaPopup(ccomma.get(0),true);ga_log("comma","explain",ccomma.attr("data-types"))}function skipNonText(c,a){var b=true;while(b){b=false;while(/^\s$/.test(c.charAt(a))){++a}while(a<c.length&&c.charAt(a)==="<"){while(a<c.length&&c.charAt(a)!==">"){++a}b=true;++a}while(a<c.length&&c.charAt(a)==="&"){while(a<c.length&&c.charAt(a)!==";"){++a}b=true;++a}while(/^\s$/.test(c.charAt(a))){++a}}return a}function commaCreateInline(c,l,q){var d=$(tinyMCE.activeEditor.getBody()).find("#s"+c);var h=d.html();var m=/[^\d\wa-zA-ZéÉöÖæÆøØåÅ.,]/ig;var o=/[<>]/;var f="error";var g=",";if(q[1].indexOf("%nok-")===0){if(opt_green){return}f="no"}else{if(opt_maybe&&q[1].indexOf("%ko-")===0){f="maybe"}else{f="yes"}}if(q[1].indexOf("%k-stop")!=-1){g="."}l=$.trim(l.replace(/\s+/g,"").replace(m,"\ue000"));if(f==="no"){l+=","}var a=0;var k=0;for(;k<h.length;++k){k=skipNonText(h,k);for(var n=a;n<l.length&&n<a+10;++n){if(l.charAt(n)===h.charAt(k)||(l.charAt(n)==="\ue000"&&!o.test(h.charAt(k))&&m.test(h.charAt(k)))){a=n;while(a<l.length-1&&l.charAt(a)===h.charAt(k)){++a;k=skipNonText(h,k+1)}break}}if(a>=l.length-1){var j=q[0];if(f!=="no"&&j&&j.length){var e=skipNonText(h,k+1);if(h.charAt(e)===j.charAt(0)){if(h.charAt(e-1)===">"){while(e>0&&h.charAt(e)!=="<"){--e}}k=e-2}}break}}if(opt_color){if(g==="."){}else{if(f==="no"){g="✗"}else{if(f==="yes"){g="✓"}else{g="?"}}}}var b='<span class="comma comma-'+f+'" data-types="'+q[1]+'">'+g+"</span> ";if(f==="no"){h=h.substr(0,k)+b+h.substr(k+1)}else{h=h.substr(0,k+1)+b+h.substr(k+1)}h=h.replace("&nbsp;"," ").replace(/  +/g," ");d.html(h);$(d).find("span.comma").off().click(commaInlineClick)}function commaDo(a){var e=$(tinyMCE.activeEditor.getBody());e.find(".popover").remove();var d=e.find("span.comma");d.popover("destroy");if(!ccomma){return}var f=0;for(var b=0;b<d.length;++b){if(d[b]===ccomma.get(0)){f=b}}ccomma.replaceWith(a);ccomma=null;if(e.find("span.comma").length==0){$("#btn-correct-all,#btn-wrong-all,#btn-close").addClass("disabled");doneOpen("#btn-correct-all");e.attr("contenteditable",true)}else{e.removeAttr("contenteditable");d=e.find("span.comma");if(f>=d.length){--f}d.eq(f).click()}}function commaAccept(){if(!ccomma){return}var a=",";if(ccomma.attr("data-types").indexOf("%k-stop")!=-1){a="."}ga_log("comma","accept",ccomma.attr("data-types"));commaDo(a)}function commaDiscard(){ga_log("comma","discard",ccomma.attr("data-types"));commaDo("")}function parseCommas(f){if(!f.hasOwnProperty("c")){var h=$(tinyMCE.activeEditor.getBody()).html();if(ts_fail<2){++ts_fail;--to_send_i;log_warning({e:"empty",d:f,l:h.length,b:h.substr(0,Defs.MAX_RQ_SIZE)});send_text();return 0}log_error({e:"empty",d:f,l:h.length,b:h.substr(0,Defs.MAX_RQ_SIZE)});alert("Svaret fra serveren var tomt - prøv evt. igen.");return -1}ts_fail=0;f=f.c;f=sanitize_result(f);if(ts_slow){clearTimeout(ts_slow)}ts_xhr=null;ts_slow=null;last_result+=f+"\n\n";var a=$.trim(f.replace(/\n+<\/s>\n+/g,"\n\n")).split(/<\/s\d+>/);for(var e=0;e<a.length;++e){var o=$.trim(a[e]);if(!o){continue}var q=o.split(/\n/);var b=q[0].replace(/^<s(.+)>$/,"$1");var f="";for(var d=1;d<q.length;++d){var p=q[d].split(/\t/);p[0]=$.trim(p[0].replace(/(\S)=/g,"$1 "));if(p[0]===""){continue}if(p.length>1){var n=p[1].split(/ /g);var l=[];for(var c=0;c<n.length;++c){if(ctypes[n[c]][1]<=opt_level){l.push(n[c])}}if(l.length){p[1]=l.join(" ")}else{p.pop()}}if(p.length>1){commaCreateInline(b,f,p)}if(p[0]!==","||p.length===1){if(p[0].search(/^[-,.:;?!$*½§£$%&()={}+]$/)===-1){f+=" "}f+=p[0]}}}$("#btn-check,#btn-correct-all,#btn-wrong-all,#btn-options,#btn-close").removeClass("disabled");$("#working").hide();var m=$(tinyMCE.activeEditor.getBody());m.removeAttr("contenteditable");if(!ccomma){var g=m.find("span.comma").first();if(g.length){g.focus().click()}}send_text()}function parseCommas_safe(a){try{var d=parseCommas(a);if(d&&d===-1){commaIgnoreAll()}}catch(c){var b=$(tinyMCE.activeEditor.getBody()).html();log_error({e:"parse",d:a,l:b.length,b:b.substr(0,Defs.MAX_RQ_SIZE)});$("#warning").html("Der opstod en kritisk fejl under håndteringen af svaret fra serveren. Prøv evt. igen. Hvis du kan reproducere fejlen, kontakt venligst support med et eksempel på input der forårsager fejlen.");$("#warning").show();commaIgnoreAll()}}function send_text(){if(to_send_i<to_send.length){var b=to_send[to_send_i];++to_send_i;if($.trim(b).length===0){return send_text()}var a={t:b,r:ts_fail,};ts_xhr=$.post("./callback.php?a=comma",a).success(parseCommas_safe).fail(function(){checkDone();alert("Kunne ikke gennemføre komma-checkning - er du sikker på at du har adgang til dette værktøj?");mvid_keepalive_at(100)})}else{if(!ccomma){doneOpen("#btn-check")}}}function commaIgnoreAll(){var a=$(tinyMCE.activeEditor.getBody());a.find(".popover").remove();a.find("span.comma").popover("destroy");a.find("span.comma").each(function(){if($(this).hasClass("comma-no")){$(this).replaceWith(",")}else{$(this).remove()}});a.attr("contenteditable",true).focus();$("#btn-correct-all,#btn-wrong-all,#btn-close").addClass("disabled");ccomma=null;$("#working").hide()}function checkDone(){if(ts_slow){clearTimeout(ts_slow)}ts_slow=null;if(tinyMCE&&tinyMCE.activeEditor){var a=$(tinyMCE.activeEditor.getBody());commaIgnoreAll();a.find(tnjq).removeAttr("id")}}function check(k,v){if($("#btn-check").hasClass("disabled")){return}checkDone();$("#btn-check").addClass("disabled");var f=$("iframe");$("#working").show().offset(f.offset()).width(f.width()).height(f.height()).focus().find("span").text("arbejder, vent lidt");var b=$(tinyMCE.activeEditor.getBody());var h=b.html();if(h.indexOf("&nbsp;")!=-1||h.indexOf("  ")!=-1){b.html(h.replace(/&nbsp;/g," ").replace(/ +/g," "))}b.removeAttr("contenteditable");b.css("overflow-y","scroll");b.find("div.unwrap").each(function(){$(this).children().unwrap()});last_result="";to_send=[];to_send_i=0;ccomma=null;var t=$(findTextNodes(b.get(0))).closest(tnjq).get();for(var x=0;x<t.length;++x){var l=false;var o=[];var g=false;for(var w=0;w<t[x].childNodes.length;++w){if($.inArray(t[x].childNodes[w].nodeName,text_nodes)!==-1){if(o.length&&g){$(o).wrapAll('<div class="unwrap"></div>')}l=true;o=[];g=false;continue}if(t[x].childNodes[w].nodeType===1||(t[x].childNodes[w].nodeType===3&&/\S/.test(t[x].childNodes[w].nodeValue))){g=true}o.push(t[x].childNodes[w])}if(o.length&&l&&g){$(o).wrapAll('<div class="unwrap"></div>')}}var u=[];if(v){var a=findTextNodes(b.get(0));var n=findTextNodes(v.getStart())[0];var y=findTextNodes(v.getEnd())[0];var d=false;for(var x=0;x<a.length;++x){if(a[x]==n){d=true}if(d){u.push(a[x])}if(a[x]==y){break}}u=$(u).closest(tnjq).get()}else{u=$(findTextNodes(b.get(0))).closest(tnjq).get()}var m="";for(var x=0;x<u.length;++x){var r=$(u[x]);var c=$.trim(r.html().replace(/<br\/?\s*>/g,"\n").replace(/<[^>]+>/g,""));if(!c){continue}var q=x+1;r.attr("id","s"+q);m+="<s"+q+">\n"+c+"\n</s"+q+">\n\n";if(m.length>=2048){to_send.push(m);m=""}}to_send.push(m);if(!m&&!to_send.length){return}if(ts_slow){clearTimeout(ts_slow)}ts_slow=setTimeout(check_slow,5000);send_text()}function checkAll(){check(this)};